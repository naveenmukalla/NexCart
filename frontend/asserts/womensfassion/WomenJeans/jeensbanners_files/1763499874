(function($){Vue.component('product-item',{props:{hasHoverImage:{type:Boolean,default:!1,},index:{type:Number,default:0,},listName:{type:String,default:null,},product:{type:Object,required:!0,},sizes:{type:Boolean,default:!1,},swatches:{type:Number,default:6,},isSlider:{type:Boolean,default:!1,},},data(){return{inWishlist:this.product.stylecolour.inwishlist,selectedSize:'',isMobile:ps.currentBreakpoint==='md',showAltImage:!1,selectedBNPL:'Buy now, pay later',isSliderInteracted:!1,isSliderVisible:!1,isHovered:!1,hasLoadedHoverImage:!1,}},computed:{galleryOptions(){return{slidesPerView:1,slidesPerGroup:1,navigation:this.styleColour.images?.length>1?{nextEl:'.swiper-button-next',prevEl:'.swiper-button-prev',}:!1,}},savings(){const difference=parseFloat(this.variant.baseunitprice,10)-parseFloat(this.variant.unitprice);return Math.round((difference/this.variant.baseunitprice)*100)},styleColour(){return this.product.stylecolour},variant(){return this.styleColour.variant},currency(){const{currency}=this.styleColour.variant;let currencySymbol='';switch(currency){case 'GBP':currencySymbol='&pound;';break;default:currencySymbol='$';break}
return `${currency} ${currencySymbol}`},bnplOptions(){return this.variant.payments},highestBaseUnitPrice(){return this.getHighestAmount(Object.values(this.styleColour.variants),'baseunitprice')},highestUnitPrice(){return this.getHighestAmount(Object.values(this.styleColour.variants),'unitprice')},productImages(){if(this.styleColour.images&&this.styleColour.images.length){if(this.isMobile){return this.styleColour.images}else{return this.styleColour.images.slice(0,2)}}
return[this.styleColour.primaryimage]},colourSwatches(){let swatchArray=[];if(Array.isArray(this.styleColour?.attributes?.colourswatches)){swatchArray=this.styleColour.attributes.colourswatches.slice()}
if(Array.isArray(this.styleColour?.attributes?.relatedcolourswatches)){swatchArray=swatchArray.concat(this.styleColour.attributes.relatedcolourswatches)}
return swatchArray},maxColourSwatches(){const self=this;let currentSwatchIndex=0;this.colourSwatches.forEach((swatch,index)=>{if(swatch.stylecolourid===self.styleColour.stylecolourid){currentSwatchIndex=index}
if(swatch.analysiscolour==='Navy'){swatch.colourswatch.code='#000080'}
if(swatch.analysiscolour==='Natural'){swatch.colourswatch.code='#E5D3Bf'}
if(swatch.analysiscolour==='Denim'){swatch.colourswatch.code='#6F8FAF'}
if(swatch.analysiscolour==='Coral'){swatch.colourswatch.code='#FF7F50'}
if(swatch.analysiscolour==='Turquoise'){swatch.colourswatch.code='#30D5C8'}});const currentSwatch=this.colourSwatches.splice(currentSwatchIndex,1)[0];this.colourSwatches.unshift(currentSwatch);return this.colourSwatches.slice(0,this.swatches)},image(){return this.styleColour.primaryimage},hoverImage(){if(!this.isMobile&&this.hasLoadedHoverImage&&this.styleColour.images?.length>1){return this.styleColour.images[1]}
return null},imageAlt(){if(this.styleColour.images&&this.styleColour.images.length>1&&this.showAltImage){return this.styleColour.images.filter((image)=>!image.primary)[0]}
return!1},imageWide(){return this.styleColour.imageswide},gaImpressionData(){const additionalData={};if(this.index){additionalData.index=this.index}
if(this.listName){additionalData.list=this.listName;if(!this.listName.includes('Search')){additionalData.gaCategory=this.listName.split('|')[0].split('/').map((category)=>category.trim())}}
return{name:'view_item_list',data:$.extend(this.styleColour.variant.gadata,additionalData),}},upsell(){return this.styleColour.variant.upsell},clickCollectData(){return this.product?.productdelivery?.clickcollect},shippingData(){return this.product?.productdelivery?.shipping},hasExtendedSizesFlag(){return this.styleColour.flag?.map((flag)=>flag.text).includes('Extended Sizes')},},watch:{isSliderInteracted(newVal){if(newVal){this.$nextTick(()=>{setTimeout(()=>{const swiper=this.$refs.productItemImages?.swiper;if(swiper){swiper.update()}},200)})}},},mounted(){this.checkBreakpoint();this.initLazyLoading()},methods:{setHovered(value){if(!this.isMobile){this.isHovered=value;if(value&&this.styleColour.images?.length>1){this.hasLoadedHoverImage=!0}}},addToCart(barcode,quantity){peppercheckout.globals.$eventbus.$emit('addproducttocart',{variantid:barcode,quantity,})},selectBNPL(value){this.selectedBNPL=value.value.type},priceFormat(value){return new Intl.NumberFormat('en-NZ',{style:'currency',currency:'NZD',}).format(parseFloat(value))},getHighestAmount(variants,property){let highest=0;for(let i=0;i<variants.length;i++){if(variants[i].status==='disabled'){continue}
if(highest<parseFloat(variants[i][property])){highest=parseFloat(variants[i][property])}}
if(highest<=0){highest=parseFloat(variants[0][property])}
return highest.toFixed(2)},toggleAltImage(){if(this.hasHoverImage){this.showAltImage=!this.showAltImage}},toggleWishlist(){const self=this;peppercheckout.globals.$eventbus.$emit('togglewishlistitem',{stylecolourid:self.styleColour.stylecolourid,barcode:self.styleColour.barcode,},this.toggleWishlistComplete)},toggleWishlistComplete(response){if(response.status){this.inWishlist=!this.inWishlist;if(this.inWishlist){$(document).trigger('psevent',['productClickWishlist',this.styleColour.variant.gadata])}}else{$.slideIn.open({url:'/login-slide-in',class:'ps-slide-in--login',})}},trackClick(){$(document).trigger('psevent',['productClick',this.styleColour.variant.gadata])},checkBreakpoint(){enquire.register(`(max-width: ${ps.breakpoints.lg}px)`,{match:()=>{this.isMobile=!0},});enquire.register(`(min-width: ${ps.breakpoints.lg + 1}px)`,{match:()=>{this.isMobile=!1},})},initLazyLoading(){if('IntersectionObserver' in window){this.lazyload=new IntersectionObserver((entries)=>{entries.forEach((elem)=>{if(elem.isIntersecting){if(this.isSlider){this.initSlider()}
this.lazyload.disconnect()}})});this.lazyload.observe(this.$refs.productItem)}},initSlider(){this.isSliderVisible=!0;if(this.productImages.length&&this.$refs.productItemImages){this.$nextTick(()=>{this.$refs.productItemImages.initSwiper()})}},destroySlider(){this.isSliderVisible=!1},},template:'#vc-component-product-item',});Vue.component('star-rating',{props:{rating:{type:Number,required:!0,},max:{type:Number,default:5,},},computed:{ratingArray(){return this.rating.toString().split('.')},fullStars(){return parseInt(this.ratingArray[0],10)},halfStars(){return this.ratingArray[1]?1:0},emptyStars(){return this.max-this.fullStars-this.halfStars},},template:'#vc-component-star-rating',});Vue.component('product-flag',{props:{flag:{type:Object,default(){return{}},},},computed:{flagClass(){if(!this.flag.text)return'';return `s-flag--${this.flag.text.replace(' ', '-').toLowerCase()}`},style(){const styles={};if(this.flag.bgcolourcode){styles.backgroundColor=this.flag.bgcolourcode}
if(this.flag.colourcode){styles.color=this.flag.colourcode}
return styles},},template:'#vc-component-product-flag',});Vue.component('site-breadcrumbs',{props:{breadcrumbs:{type:[Array,Object],default(){return[]},},},template:'#vc-component-site-breadcrumbs',})}(jQuery))